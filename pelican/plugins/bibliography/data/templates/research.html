{% extends "!theme/page.html" %}

{% macro citation_for(ref) -%}
<a target="_blank" href="{{ ref.metadata.ref_href }}">
    <i class="fa fa-quote-right fa-1"></i>
</a>
{%- endmacro %}

{% macro bibentry(ref) -%}
<p class="ref" id="{{ ref.metadata.key }}">
    <a class="jump" href="#{{ ref.metadata.key }}"></a>
    <span class="ref-author-list">
        {% for author in ref.fields.author -%}
        {% if loop.last and not loop.first %} and {% endif %}<span class="ref-author"
            data-given="{{ author.get('given') }}" data-family="{{ author.family }}">{{ author.get('given') }} {{
            author.family }}</span>{% if not loop.last %}, {% else %}.{% endif %}
        {%- endfor %}
    </span>
    <span class="ref-title">"{{ ref.fields.title }}."</span>
    <span class="ref-container">{{ ref.fields.container_title_short or ref.fields.container_title or (ref.fields.type |
        title) or 'Other' }}.</span>
    <span class="ref-date">{{ ref.fields.get('issued', {}).get('year') }}.</span>
    {% for link in ref.metadata.links %}
    <a target="_blank" href="{{ link.href }}"><i class="fa fa-{{ link.icon }} fa-1"></i></a>
    {% endfor %}
    {{ citation_for(ref) }}
</p>
{%- endmacro %}

{% block page_content %}
{{ page.content }}

<h2>Publications</h2>
{% for ref in bibliography | sort(reverse=True, attribute='sortkey') %}
{{ bibentry(ref) }}
{% endfor %}

{% endblock %}

{% block meta %}
{{ super() }}

<style>

/* jump links for research page, adapted from 6031 */
.margin {
  position: fixed;
  height: 100%;
}

a.jump {
  opacity: 0;
  position: absolute;
  left: 2em;
  padding: 0 2em 2em 2em;
  transition: opacity .5s 0s;
}

a.jump::after {
  content: '#';
}

.margin:hover ~ * a.jump,
p:hover > a.jump,
a.jump:hover {
  opacity: 1;
  transition: opacity .5s 0s;
}

[id]:target {
  animation: highlightout 3s;
}
@keyframes highlightout {
  from { background: #fcf8e3; }
}
/* end of jump links */
</style>

{% endblock %}
